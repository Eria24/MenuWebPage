// Base64-encoded Excel file (replace this with your actual Base64 string)
const excelBase64 = "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"

function base64ToArrayBuffer(base64) {
  const binaryString = atob(base64);
  const bytes = new Uint8Array(binaryString.length);
  for (let i = 0; i < binaryString.length; i++) {
    bytes[i] = binaryString.charCodeAt(i);
  }
  return bytes.buffer;
}

function loadExcelData() {
  const data = base64ToArrayBuffer(excelBase64);
  const workbook = XLSX.read(data, { type: 'array' });
  const sheet = workbook.Sheets[workbook.SheetNames[0]];
  const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
  displayMenu(jsonData);
}

function setViewportHeight() {
  let vh = window.innerHeight * 0.01;
  document.documentElement.style.setProperty('--vh', `${vh}px`);
}

window.addEventListener('resize', setViewportHeight);
window.addEventListener('load', setViewportHeight);
window.addEventListener('scroll', setViewportHeight);

function displayMenu(data) {
  const container = document.getElementById('menuContainer');
  container.innerHTML = '';
  let currentCategory = '';

  for (let i = 1; i < data.length; i++) { // Skip header row
    const [itemName, description, category] = data[i];

    
    if (category !== currentCategory) {
      const categoryHeader = document.createElement('div');
      categoryHeader.className = 'category';
      categoryHeader.textContent = '⋆｡‧˚ʚ⋆' + category + '⋆ɞ˚‧｡⋆';
      container.appendChild(categoryHeader);
      currentCategory = category;
    }

    
    const menuItemWrapper = document.createElement('div');
    menuItemWrapper.className = 'menu-item';

    
    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.name = 'menu';
    checkbox.value = itemName;

    
    const itemLabel = document.createElement('label');
    itemLabel.textContent = itemName;
    itemLabel.classList.add('item-label');

   
    const descriptionDiv = document.createElement('div');
    descriptionDiv.textContent = description;
    descriptionDiv.className = 'description';

   
    menuItemWrapper.appendChild(checkbox);
    menuItemWrapper.appendChild(itemLabel);
    menuItemWrapper.appendChild(descriptionDiv);

   
    container.appendChild(menuItemWrapper);
  }
}

document.getElementById("submitBtn").addEventListener("click", () => {
  const selectedCheckboxes = document.querySelectorAll("input[name='menu']:checked");
  if (selectedCheckboxes.length === 0) {
    alert("Please select at least one menu item.");
    return;
  }

  const selectedMenuItems = Array.from(selectedCheckboxes).map(checkbox => checkbox.value).join(", ");

  emailjs.init("9pH66rvLirSCtjqGe");  // Replace with your EmailJS user ID

  emailjs.send("eria", "eria_temp", {
    menu_item: selectedMenuItems,
  })
  .then(response => {
    document.getElementById("menuContainer").style.display = "none";
    document.getElementById("submitBtn").style.display = "none";
  
   
    const successMessage = document.getElementById("successMessage");
   
    successMessage.classList.remove("hidden");
  
    const img = document.createElement("img");
    img.src = "end.jpg";
    img.alt = "Success Image";
    
    
    successMessage.appendChild(img);
  
    document.body.style.overflow = 'hidden';
    setTimeout(() => {
      document.body.style.overflow = 'auto';
    }, 100);
  })
    .catch(error => {
        console.error("Failed to send email. Error:", error);
        alert("Failed to send email. Please try again later.");
    });
});
// Load the menu on page load
loadExcelData();
